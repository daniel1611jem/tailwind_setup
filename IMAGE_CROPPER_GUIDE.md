# âœ‚ï¸ Image Cropper - Cáº¯t áº£nh theo khung thiáº¿t bá»‹

## ðŸŽ¯ Tá»•ng quan

CÃ´ng cá»¥ cáº¯t áº£nh thÃ´ng minh vá»›i cÃ¡c khung cáº¯t máº«u theo kÃ­ch thÆ°á»›c thiáº¿t bá»‹ phá»• biáº¿n:
- **iPhone**: 11 Pro, 12/13/14, Pro Max, SE
- **Samsung**: S21, S21 Ultra, Note 20
- **Social Media**: Instagram, Facebook, Twitter
- **ID Cards**: CMND/CCCD, Passport
- **Common ratios**: 1:1, 4:3, 16:9, 3:2, v.v.

## âœ¨ TÃ­nh nÄƒng chÃ­nh

### 1ï¸âƒ£ Khung máº«u (Presets)
- 18+ khung máº«u sáºµn cÃ³
- PhÃ¢n loáº¡i theo category: iPhone, Samsung, Social Media, ID Card, Common, Camera
- Aspect ratio chÃ­nh xÃ¡c theo thiáº¿t bá»‹ thá»±c táº¿
- KÃ­ch thÆ°á»›c output tá»‘i Æ°u

### 2ï¸âƒ£ TÃ¹y chá»‰nh (Custom)
- Nháº­p kÃ­ch thÆ°á»›c tÃ¹y Ã½ (width Ã— height)
- Quick ratio buttons: 1:1, 4:3, 16:9, 9:16, 3:2, 2:3
- Preview trá»±c tiáº¿p trÃªn canvas

### 3ï¸âƒ£ Canvas tÆ°Æ¡ng tÃ¡c
- Drag & drop Ä‘á»ƒ di chuyá»ƒn vÃ¹ng cáº¯t
- Zoom in/out (50% - 200%)
- Hiá»ƒn thá»‹ kÃ­ch thÆ°á»›c real-time
- Visual feedback vá»›i overlay tá»‘i

### 4ï¸âƒ£ Export cháº¥t lÆ°á»£ng cao
- Output JPEG vá»›i quality 95%
- Resize chÃ­nh xÃ¡c theo preset
- Download trá»±c tiáº¿p vá» mÃ¡y
- Filename tá»± Ä‘á»™ng thÃªm suffix "_cropped"

## ðŸš€ HÆ°á»›ng dáº«n sá»­ dá»¥ng

### CÃ¡ch 1: Cáº¯t áº£nh tá»« danh sÃ¡ch Media

```
1. VÃ o tab "Quáº£n LÃ½ Media"
2. TÃ¬m áº£nh cáº§n cáº¯t trong grid
3. Click nÃºt "âœ‚ï¸ Cáº¯t"
4. Chá»n khung máº«u hoáº·c nháº­p kÃ­ch thÆ°á»›c tÃ¹y chá»‰nh
5. Di chuyá»ƒn/zoom vÃ¹ng cáº¯t
6. Click "âœ‚ï¸ Cáº¯t áº£nh vÃ  táº£i vá»"
7. âœ“ File Ä‘Ã£ Ä‘Æ°á»£c táº£i vá»!
```

### CÃ¡ch 2: Cáº¯t áº£nh tá»« mÃ¡y tÃ­nh

```
1. VÃ o tab "Quáº£n LÃ½ Media"
2. Click box "Cáº¯t áº£nh thÃ´ng minh" â†’ "Chá»n áº£nh tá»« mÃ¡y"
3. Chá»n file áº£nh tá»« mÃ¡y tÃ­nh
4. Chá»n khung máº«u
5. Adjust vÃ¹ng cáº¯t
6. Click "âœ‚ï¸ Cáº¯t áº£nh vÃ  táº£i vá»"
```

### CÃ¡ch 3: Drag trong Canvas

```
1. Má»Ÿ Image Cropper
2. Click vÃ  drag trÃªn canvas Ä‘á»ƒ di chuyá»ƒn vÃ¹ng cáº¯t
3. Scroll hoáº·c dÃ¹ng slider Zoom Ä‘á»ƒ phÃ³ng to/thu nhá»
4. Chá»n preset Ä‘á»ƒ thay Ä‘á»•i tá»· lá»‡
5. Cáº¯t khi hÃ i lÃ²ng
```

## ðŸ“± Danh sÃ¡ch khung máº«u

### iPhone
| TÃªn | KÃ­ch thÆ°á»›c | Aspect Ratio | Thiáº¿t bá»‹ |
|-----|-----------|--------------|----------|
| iPhone 11 Pro | 1125Ã—2436 | 1125:2436 | iPhone 11 Pro, X, XS |
| iPhone 12/13/14 | 1170Ã—2532 | 1170:2532 | iPhone 12, 12 Pro, 13, 13 Pro, 14, 14 Pro |
| iPhone 12/13/14 Pro Max | 1284Ã—2778 | 1284:2778 | iPhone 12 Pro Max, 13 Pro Max, 14 Pro Max |
| iPhone SE (2020) | 750Ã—1334 | 750:1334 | iPhone SE (2nd/3rd gen), 6, 7, 8 |

### Samsung
| TÃªn | KÃ­ch thÆ°á»›c | Aspect Ratio | Thiáº¿t bá»‹ |
|-----|-----------|--------------|----------|
| Samsung S21 | 1080Ã—2400 | 1080:2400 | Galaxy S21, S21+, S22, S23 |
| Samsung S21 Ultra | 1440Ã—3200 | 1440:3200 | Galaxy S21 Ultra, S22 Ultra, S23 Ultra |
| Samsung Note 20 | 1080Ã—2400 | 1080:2400 | Galaxy Note 20, Note 20 Ultra |

### Social Media
| TÃªn | KÃ­ch thÆ°á»›c | Aspect Ratio | Use Case |
|-----|-----------|--------------|----------|
| Instagram Post | 1080Ã—1080 | 1:1 | Feed post (square) |
| Instagram Story | 1080Ã—1920 | 9:16 | Story, Reels |
| Facebook Cover | 820Ã—312 | 820:312 | Page cover photo |
| Twitter Header | 1500Ã—500 | 3:1 | Profile header |

### ID Card / Documents
| TÃªn | KÃ­ch thÆ°á»›c | Aspect Ratio | Use Case |
|-----|-----------|--------------|----------|
| CMND/CCCD (TrÆ°á»›c) | 858Ã—540 | 858:540 | CÄƒn cÆ°á»›c cÃ´ng dÃ¢n VN |
| Passport Photo | 600Ã—800 | 3:4 | Passport standard |

### Common Ratios
| TÃªn | KÃ­ch thÆ°á»›c | Aspect Ratio | Use Case |
|-----|-----------|--------------|----------|
| 1:1 (Square) | 1080Ã—1080 | 1:1 | Social media, profile pictures |
| 4:3 (Standard) | 1600Ã—1200 | 4:3 | Classic photos, presentations |
| 16:9 (Widescreen) | 1920Ã—1080 | 16:9 | YouTube, monitors, TV |
| 3:2 (DSLR) | 3000Ã—2000 | 3:2 | Professional photography |

## ðŸŽ¨ UI/UX Features

### Canvas
- **Background**: MÃ u Ä‘en (#000) Ä‘á»ƒ highlight áº£nh
- **Overlay**: Dimmed area (50% opacity) ngoÃ i vÃ¹ng cáº¯t
- **Crop border**: Blue (#3b82f6), 2px
- **Corner handles**: Blue squares (10Ã—10px)
- **Dimension label**: Blue badge hiá»ƒn thá»‹ kÃ­ch thÆ°á»›c

### Controls
- **Zoom slider**: 50% - 200%, step 10%
- **Drag**: Click vÃ  kÃ©o Ä‘á»ƒ di chuyá»ƒn
- **Preset buttons**: Highlight active preset vá»›i blue background
- **Categories**: Group presets theo loáº¡i Ä‘á»ƒ dá»… tÃ¬m

### Info Display
```
áº¢nh gá»‘c: 4000 Ã— 3000px
VÃ¹ng cáº¯t: 1920 Ã— 1080px
KÃ­ch thÆ°á»›c xuáº¥t: 1920 Ã— 1080px
```

## ðŸ’¡ Use Cases thá»±c táº¿

### Use Case 1: Chá»¥p mÃ n hÃ¬nh Ä‘iá»‡n thoáº¡i
**TÃ¬nh huá»‘ng**: CÃ³ screenshot tá»« iPhone, cáº§n crop cho Ä‘Ãºng tá»· lá»‡ Ä‘á»ƒ lÃ m mockup

**Giáº£i phÃ¡p**:
1. Upload screenshot
2. Chá»n preset "iPhone 12/13/14"
3. Adjust vÃ¹ng cáº¯t
4. Export â†’ Perfect phone mockup!

### Use Case 2: áº¢nh CMND/CCCD cho KYC
**TÃ¬nh huá»‘ng**: áº¢nh CMND chá»¥p báº±ng camera, cÃ³ background, cáº§n crop chá»‰ láº¥y tháº»

**Giáº£i phÃ¡p**:
1. Upload áº£nh CMND Ä‘Ã£ chá»¥p
2. Chá»n preset "CMND/CCCD (TrÆ°á»›c)"
3. Drag vÃ¹ng cáº¯t Ä‘á»ƒ align vá»›i tháº»
4. Export â†’ áº¢nh CMND chuáº©n 858Ã—540px

### Use Case 3: Batch Instagram posts
**TÃ¬nh huá»‘ng**: 50 áº£nh ngang (16:9) cáº§n crop thÃ nh square cho Instagram

**Workflow**:
1. Open cropper vá»›i áº£nh Ä‘áº§u tiÃªn
2. Chá»n preset "Instagram Post" (1:1)
3. Crop vÃ  save
4. Repeat cho 49 áº£nh cÃ²n láº¡i (má»—i áº£nh ~10 giÃ¢y)
5. 50 áº£nh Ã— 10s = ~8 phÃºt

### Use Case 4: YouTube Thumbnail
**TÃ¬nh huá»‘ng**: Design thumbnail 1920Ã—1080 tá»« áº£nh 4K

**Giáº£i phÃ¡p**:
1. Upload áº£nh 4K
2. Chá»n preset "16:9 (Widescreen)"
3. Zoom vÃ  frame Ä‘Ãºng composition
4. Export â†’ Perfect 1920Ã—1080 thumbnail!

### Use Case 5: Social Media headers
**TÃ¬nh huá»‘ng**: Cáº§n táº¡o cover photo cho Facebook vÃ  Twitter

**Workflow**:
1. Upload áº£nh Ä‘áº¹p
2. Crop vá»›i preset "Facebook Cover" â†’ Save
3. Open láº¡i cÃ¹ng áº£nh
4. Crop vá»›i preset "Twitter Header" â†’ Save
5. Xong! CÃ³ 2 sizes chuáº©n cho 2 platforms

## ðŸ”§ Technical Details

### Canvas Size
```javascript
width: 800px
height: 600px
```

### Image Scaling
```javascript
// Fit image to canvas maintaining aspect ratio
if (imgAspect > canvasAspect) {
  drawWidth = canvasWidth * scale;
  drawHeight = drawWidth / imgAspect;
} else {
  drawHeight = canvasHeight * scale;
  drawWidth = drawHeight * imgAspect;
}
```

### Crop Calculation
```javascript
// Convert canvas coordinates to image coordinates
const scaleX = image.naturalWidth / drawWidth;
const scaleY = image.naturalHeight / drawHeight;

const imageX = cropArea.x;
const imageY = cropArea.y;
const imageWidth = cropArea.width;
const imageHeight = cropArea.height;
```

### Export Quality
```javascript
cropCanvas.toBlob((blob) => {
  // blob ready for download
}, 'image/jpeg', 0.95); // 95% quality
```

### Preset Application
```javascript
const aspectRatio = preset.width / preset.height;

// Fit crop area maintaining aspect ratio
let newWidth = Math.min(image.naturalWidth * 0.9, image.naturalWidth);
let newHeight = newWidth / aspectRatio;

if (newHeight > image.naturalHeight * 0.9) {
  newHeight = image.naturalHeight * 0.9;
  newWidth = newHeight * aspectRatio;
}

// Center crop area
setCropArea({
  x: (image.naturalWidth - newWidth) / 2,
  y: (image.naturalHeight - newHeight) / 2,
  width: newWidth,
  height: newHeight
});
```

## ðŸ“Š Supported Formats

### Input
- âœ… JPEG/JPG
- âœ… PNG
- âœ… WebP
- âœ… TIFF
- âœ… BMP
- âœ… All browser-supported image formats

### Output
- ðŸ“¤ JPEG (quality 95%)

## âš™ï¸ Customization Options

### Preset Structure
```javascript
{
  name: 'iPhone 12',      // Display name
  width: 1170,            // Output width (px)
  height: 2532,           // Output height (px)
  aspectRatio: 1170/2532, // Pre-calculated ratio
  category: 'iPhone',     // Group category
  icon: 'ðŸ“±'              // Display icon
}
```

### Adding New Preset
```javascript
// In ImageCropper.jsx, devicePresets array:
{
  name: 'Your Device',
  width: 1440,
  height: 2960,
  aspectRatio: 1440/2960,
  category: 'Custom',
  icon: 'ðŸ“±'
}
```

## ðŸŽ¯ Best Practices

### 1. Choosing Presets
- **Social Media**: Use exact presets for platforms
- **ID Cards**: Always use standard presets
- **Custom sizes**: Use "TÃ¹y chá»‰nh" tab

### 2. Image Quality
- Start with high-resolution images
- Crop first, then resize if needed
- Use 95% JPEG quality for balance

### 3. Workflow Tips
- Use Quick Ratio buttons for common ratios
- Zoom in for precision cropping
- Preview dimension label before export

### 4. Performance
- Large images (>5MB) may take a few seconds to load
- Canvas rendering is real-time (no lag)
- Export is instant (<1s for most images)

## ðŸš« Limitations

### Current Limitations
- âŒ Cannot crop multiple images at once (batch mode)
- âŒ Cannot save crop position for later
- âŒ Cannot rotate image before cropping
- âŒ Output is always JPEG (no PNG transparency)

### Workarounds
- **Batch**: Open cropper multiple times (still faster than manual)
- **Save position**: Take screenshot of canvas for reference
- **Rotate**: Rotate image before uploading
- **PNG**: Use other tools for transparent images

## ðŸ”® Future Enhancements

### Planned
- [ ] Batch crop mode (select multiple images)
- [ ] Save crop templates
- [ ] Image rotation within cropper
- [ ] PNG output with transparency
- [ ] More device presets (iPad, tablets, etc.)
- [ ] Free-form crop (no aspect ratio lock)
- [ ] Crop history (undo/redo)
- [ ] Direct upload to server after crop

### Maybe
- [ ] AI auto-crop (detect subject)
- [ ] Face detection for smart crop
- [ ] Grid overlay (rule of thirds)
- [ ] Filters and adjustments
- [ ] Video thumbnail extraction
- [ ] Animated GIF cropping
- [ ] PDF page cropping

## ðŸ“ Notes

### Performance Optimization
- Canvas uses requestAnimationFrame for smooth rendering
- Image scaling is done in-memory (no server calls)
- Blob URLs are cleaned up after use

### Browser Compatibility
- âœ… Chrome 90+
- âœ… Firefox 88+
- âœ… Safari 14+
- âœ… Edge 90+
- âŒ IE11 (not supported)

### Mobile Support
- âœ… Touch drag to move crop area
- âœ… Pinch zoom (limited support)
- âš ï¸ Small screen: UI may be cramped
- âœ… File picker works on mobile

## ðŸ”— Integration

### Component Props
```javascript
<ImageCropper
  imageFile={file}        // File object
  imageUrl={url}          // Preview URL (blob or http)
  onClose={() => {...}}   // Close handler
  onSave={(croppedFile, cropInfo) => {...}} // Save handler
/>
```

### Save Handler
```javascript
const handleCropSave = (croppedFile, cropInfo) => {
  // croppedFile: File object with cropped image
  // cropInfo: { preset, dimensions, originalSize }
  
  // Download or upload to server
  downloadFile(croppedFile);
  // or
  uploadToServer(croppedFile);
};
```

## ðŸ“š Related Documentation
- `EXIF_EDITOR_GUIDE.md` - EXIF metadata editor
- `EXIF_PROFILES_GUIDE.md` - EXIF profile management
- `MEDIA_MANAGER.md` - Media upload and management

---

**Version**: 1.0.0
**Date**: 26/11/2025
**Component**: `src/components/ImageCropper.jsx`
**Status**: âœ… Production ready
**Author**: GitHub Copilot
